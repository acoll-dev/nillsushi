(function() {
  'use strict';
  angular.module('mainApp').controller('finishCtrl', ["$rootScope", "$scope", "$cookies", "$grRestful", "$grModal", "$grAlert", "$cidadeEstado", "$timeout", function($rootScope, $scope, $cookies, $grRestful, $grModal, $grAlert, $cidadeEstado, $timeout) {
    var alert, cartEmpty, finished;
    alert = $grAlert["new"]();
    finished = false;
    cartEmpty = function(url) {
      alert.show('info', 'Sua lista de pedidos está vazia, você será redirecionado!');
      return $timeout(function() {
        return location.href = $rootScope.GRIFFO.curAlias + '/' + (url ? url : '');
      }, 5000);
    };
    if ($rootScope.gr.cart.length() === 0) {
      return cartEmpty();
    } else {
      $rootScope.gr.title = {
        icon: 'fa fa-fw fa-check',
        text: 'Finalizar pedido'
      };
      $scope.payments = ['Dinheiro', 'Cartão de Crédito/Débito'];
      $scope.addresses = [$rootScope.GRIFFO.user.address + ', ' + $rootScope.GRIFFO.user.number + ($rootScope.GRIFFO.user.complement ? ', ' + $rootScope.GRIFFO.user.complement : '') + ', ' + $rootScope.GRIFFO.user.district, 'Outro...'];
      $scope.shops = [];
      $grRestful.find({
        module: 'shop',
        action: 'select'
      }).then(function(r) {
        if (r.response) {
          return $scope.shops = r.response;
        }
      });
      $scope.states = [];
      angular.forEach($cidadeEstado.get.estados(), function(e) {
        $scope.states.push({
          value: e[0],
          label: e[1]
        });
      });
      delete $cookies.griffo_cart_ready;
      $scope.formSettings = {
        data: {
          status: 0,
          formpayment: 'Dinheiro',
          address: $scope.addresses[0],
          state: $rootScope.GRIFFO.user.state,
          city: $rootScope.GRIFFO.user.city,
          fkidshop: $rootScope.GRIFFO.user.fkidshop
        },
        schema: [
          {
            property: 'fkidshop',
            type: 'select',
            label: 'Loja',
            list: 'item.value as item.label for item in shops',
            columns: 6,
            attr: {
              required: true
            },
            msgs: {
              required: 'A loja é obrigatória'
            }
          }, {
            property: 'fetch',
            type: 'checkbox',
            label: 'Vai buscar?',
            columns: 6
          }, {
            property: 'formpayment',
            type: 'select',
            label: 'Forma de pagamento',
            list: 'item as item for item in payments',
            attr: {
              required: true,
              ngIf: '!formSettings.data.fetch'
            },
            msgs: {
              required: 'A forma de pagamento é obrigatória'
            }
          }, {
            property: 'change',
            type: 'money',
            label: 'LABEL.CHANGE.FOR',
            placeholder: '0,00',
            columns: 6,
            attr: {
              ngIf: 'formSettings.data.formpayment === \'Dinheiro\' && !formSettings.data.fetch'
            }
          }, {
            type: 'hr',
            attr: {
              'ng-if': '!formSettings.data.fetch'
            }
          }, {
            property: 'address',
            type: 'select',
            label: 'Endereço de entrega',
            list: 'item as item for item in addresses',
            attr: {
              required: true,
              ngIf: '!formSettings.data.fetch'
            },
            msgs: {
              required: 'O endereço de entrega é obrigatório'
            }
          }, {
            property: 'address1',
            label: 'Novo endereço',
            columns: 8,
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'O novo endereço é obrigatório'
            }
          }, {
            property: 'number',
            type: 'number',
            label: 'Número',
            columns: 4,
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'O número é obrigatório'
            }
          }, {
            property: 'complement',
            label: 'Complemento',
            columns: 6,
            attr: {
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            }
          }, {
            property: 'district',
            label: 'Bairro',
            columns: 6,
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'O bairro é obrigatório'
            }
          }, {
            property: 'state',
            type: 'select',
            label: 'Estado',
            columns: 6,
            list: 'item.value as item.label for item in states',
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'Selecione um estado'
            }
          }, {
            property: 'city',
            type: 'select',
            label: 'Cidade',
            columns: 6,
            list: 'item.value as item.label for item in cities',
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'Selecione uma cidade'
            }
          }
        ],
        submit: function(data) {
          var order;
          if (!$scope.form.$valid) {
            return;
          }
          order = {
            fkidclient: $rootScope.GRIFFO.user.id,
            fetch: data.fetch,
            subtotal: $rootScope.gr.cart.total(),
            fkidshop: data.fkidshop,
            products: []
          };
          angular.forEach($rootScope.gr.cart.items, function(item) {
            if (item.count > 0) {
              return order.products.push({
                idproduct: item.id,
                fkidshop: data.fkidshop,
                quantity: item.count
              });
            }
          });
          if (!data.fetch) {
            order.formpayment = data.formpayment ? data.formpayment : void 0;
            order.change = data.change ? data.change : void 0;
            if (data.address === 'Outro...') {
              order.address = data.address1;
              order.number = data.number;
              order.complement = data.complement;
              order.district = data.district;
              order.city = data.city;
              order.state = data.state;
            } else {
              order.address = $rootScope.GRIFFO.user.address;
              order.number = $rootScope.GRIFFO.user.number;
              order.complement = $rootScope.GRIFFO.user.complement;
              order.district = $rootScope.GRIFFO.user.district;
              order.city = $rootScope.GRIFFO.user.city;
              order.state = $rootScope.GRIFFO.user.state;
            }
          }
          return $grRestful.create({
            module: 'order',
            action: 'insert',
            post: order
          }).then(function(r) {
            if (r.response) {
              finished = true;
              $scope.form.reset();
              $rootScope.gr.cart.clear();
              alert.show(r.status, 'Seu pedido foi enviado com sucesso, você será redirecionado para acompanhar seu pedido.');
              $timeout((function() {
                location.href = $rootScope.GRIFFO.curAlias + '/user';
              }), 5000);
            } else {
              alert.show(r.status, r.message);
            }
          }, function() {
            return alert.show('danger', 'ERROR.FATAL');
          });
        }
      };
      $scope.$watch('formSettings.data.state', function(e) {
        if (e) {
          if ($scope.formSettings.data.state) {
            $scope.cities = [];
            angular.forEach($cidadeEstado.get.cidades($scope.formSettings.data.state), function(c) {
              $scope.cities.push({
                value: c,
                label: c
              });
            });
          } else {
            $scope.cities = [];
          }
          if ($scope.formSettings.data.state === 'SP') {
            return $scope.formSettings.data.city = 'Itapeva';
          } else {
            return $scope.formSettings.data.city = void 0;
          }
        } else {
          return $scope.formSettings.data.city = void 0;
        }
      });
      $scope.$watch(function() {
        return $rootScope.gr.cart.length();
      }, function() {
        if ($rootScope.gr.cart.length() === 0 && !finished) {
          return cartEmpty();
        }
      });
      return $scope.$watch('form', function(form) {
        return $rootScope.finishForm = form;
      });
    }
  }]);

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsaWVudC9sYXllcnMvd2Vic2l0ZS90ZW1wbGF0ZXMvY3JhYi9jb2ZmZWUvY29udHJvbGxlcnMvZmluaXNoQ3RybC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFBQTtFQUNBLE9BQU8sQ0FBQyxNQUFSLENBQWUsU0FBZixDQUF5QixDQUFDLFVBQTFCLENBQXFDLFlBQXJDLEVBQW1ELFNBQUMsVUFBRCxFQUFhLE1BQWIsRUFBcUIsUUFBckIsRUFBK0IsVUFBL0IsRUFBMkMsUUFBM0MsRUFBcUQsUUFBckQsRUFBK0QsYUFBL0QsRUFBOEUsUUFBOUU7QUFFL0MsUUFBQTtJQUFBLEtBQUEsR0FBUSxRQUFRLENBQUMsS0FBRCxDQUFSLENBQUE7SUFDUixRQUFBLEdBQVc7SUFFWCxTQUFBLEdBQVksU0FBQyxHQUFEO01BQ1IsS0FBSyxDQUFDLElBQU4sQ0FBVyxNQUFYLEVBQW1CLDJEQUFuQjthQUNBLFFBQUEsQ0FBUyxTQUFBO2VBQ0wsUUFBUSxDQUFDLElBQVQsR0FBZ0IsVUFBVSxDQUFDLE1BQU0sQ0FBQyxRQUFsQixHQUE2QixHQUE3QixHQUFtQyxDQUFJLEdBQUgsR0FBWSxHQUFaLEdBQXFCLEVBQXRCO01BRDlDLENBQVQsRUFFRSxJQUZGO0lBRlE7SUFNWixJQUFHLFVBQVUsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQW5CLENBQUEsQ0FBQSxLQUErQixDQUFsQzthQUNJLFNBQUEsQ0FBQSxFQURKO0tBQUEsTUFBQTtNQUdJLFVBQVUsQ0FBQyxFQUFFLENBQUMsS0FBZCxHQUNJO1FBQUEsSUFBQSxFQUFNLG1CQUFOO1FBQ0EsSUFBQSxFQUFNLGtCQUROOztNQUVKLE1BQU0sQ0FBQyxRQUFQLEdBQWtCLENBQ2QsVUFEYyxFQUVkLDBCQUZjO01BSWxCLE1BQU0sQ0FBQyxTQUFQLEdBQW1CLENBQ2YsVUFBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBdkIsR0FBaUMsSUFBakMsR0FBd0MsVUFBVSxDQUFDLE1BQU0sQ0FB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O21CQUdJLE1BQU0sQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQXpCLEdBQWdDLE9BSHBDO1dBVko7U0FBQSxNQUFBO2lCQWVJLE1BQU0sQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQXpCLEdBQWdDLE9BZnBDOztNQURxQyxDQUF6QztNQWtCQSxNQUFNLENBQUMsTUFBUCxDQUFjLFNBQUE7ZUFDVixVQUFVLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxNQUFuQixDQUFBO01BRFUsQ0FBZCxFQUVFLFNBQUE7UUFDRSxJQUFlLFVBQVUsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQW5CLENBQUEsQ0FBQSxLQUErQixDQUEvQixJQUFxQyxDQUFDLFFBQXJEO2lCQUFBLFNBQUEsQ0FBQSxFQUFBOztNQURGLENBRkY7YUFLQSxNQUFNLENBQUMsTUFBUCxDQUFjLE1BQWQsRUFBc0IsU0FBQyxJQUFEO2VBQ2xCLFVBQVUsQ0FBQyxVQUFYLEdBQXdCO01BRE4sQ0FBdEIsRUEvTko7O0VBWCtDLENBQW5EO0FBREEiLCJmaWxlIjoiY2xpZW50L2xheWVycy93ZWJzaXRlL3RlbXBsYXRlcy9jcmFiL2pzL2NvbnRyb2xsZXJzL2ZpbmlzaEN0cmwuanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8iLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcbmFuZ3VsYXIubW9kdWxlKCdtYWluQXBwJykuY29udHJvbGxlciAnZmluaXNoQ3RybCcsICgkcm9vdFNjb3BlLCAkc2NvcGUsICRjb29raWVzLCAkZ3JSZXN0ZnVsLCAkZ3JNb2RhbCwgJGdyQWxlcnQsICRjaWRhZGVFc3RhZG8sICR0aW1lb3V0KSAtPlxuICAgIFxuICAgIGFsZXJ0ID0gJGdyQWxlcnQubmV3KClcbiAgICBmaW5pc2hlZCA9IGZhbHNlXG5cbiAgICBjYXJ0RW1wdHkgPSAodXJsKSAtPlxuICAgICAgICBhbGVydC5zaG93ICdpbmZvJywgJ1N1YSBsaXN0YSBkZSBwZWRpZG9zIGVzdMOhIHZhemlhLCB2b2PDqiBzZXLDoSByZWRpcmVjaW9uYWRvISdcbiAgICAgICAgJHRpbWVvdXQgLT5cbiAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSAkcm9vdFNjb3BlLkdSSUZGTy5jdXJBbGlhcyArICcvJyArIChpZiB1cmwgdGhlbiB1cmwgZWxzZSAnJylcbiAgICAgICAgLCA1MDAwXG5cbiAgICBpZiAkcm9vdFNjb3BlLmdyLmNhcnQubGVuZ3RoKCkgPT0gMFxuICAgICAgICBjYXJ0RW1wdHkoKVxuICAgIGVsc2VcbiAgICAgICAgJHJvb3RTY29wZS5nci50aXRsZSA9XG4gICAgICAgICAgICBpY29uOiAnZmEgZmEtZncgZmEtY2hlY2snXG4gICAgICAgICAgICB0ZXh0OiAnRmluYWxpemFyIHBlZGlkbydcbiAgICAgICAgJHNjb3BlLnBheW1lbnRzID0gW1xuICAgICAgICAgICAgJ0RpbmhlaXJvJ1xuICAgICAgICAgICAgJ0NhcnTDo28gZGUgQ3LDqWRpdG8vRMOpYml0bydcbiAgICAgICAgXVxuICAgICAgICAkc2NvcGUuYWRkcmVzc2VzID0gW1xuICAgICAgICAgICAgJHJvb3RTY29wZS5HUklGRk8udXNlci5hZGRyZXNzICsgJywgJyArICRyb290U2NvcGUuR1JJRkZPLnVzZXIubnVtYmVyICsgKGlmICRyb290U2NvcGUuR1JJRkZPLnVzZXIuY29tcGxlbWVudCB0aGVuICcsICcgKyAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLmNvbXBsZW1lbnQgZWxzZSAnJykgKyAnLCAnICsgJHJvb3RTY29wZS5HUklGRk8udXNlci5kaXN0cmljdFxuICAgICAgICAgICAgJ091dHJvLi4uJ1xuICAgICAgICBdXG4gICAgICAgICRzY29wZS5zaG9wcyA9IFtdXG5cbiAgICAgICAgJGdyUmVzdGZ1bC5maW5kKFxuICAgICAgICAgICAgbW9kdWxlOiAnc2hvcCdcbiAgICAgICAgICAgIGFjdGlvbjogJ3NlbGVjdCcpLnRoZW4gKHIpIC0+XG4gICAgICAgICAgICBpZiByLnJlc3BvbnNlXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3BzID0gci5yZXNwb25zZVxuXG4gICAgICAgICRzY29wZS5zdGF0ZXMgPSBbXVxuXG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaCAkY2lkYWRlRXN0YWRvLmdldC5lc3RhZG9zKCksIChlKSAtPlxuICAgICAgICAgICAgJHNjb3BlLnN0YXRlcy5wdXNoXG4gICAgICAgICAgICAgICAgdmFsdWU6IGVbMF1cbiAgICAgICAgICAgICAgICBsYWJlbDogZVsxXVxuICAgICAgICAgICAgcmV0dXJuXG5cbiAgICAgICAgZGVsZXRlICRjb29raWVzLmdyaWZmb19jYXJ0X3JlYWR5XG5cbiAgICAgICAgJHNjb3BlLmZvcm1TZXR0aW5ncyA9XG4gICAgICAgICAgICBkYXRhOlxuICAgICAgICAgICAgICAgIHN0YXR1czogMFxuICAgICAgICAgICAgICAgIGZvcm1wYXltZW50OiAnRGluaGVpcm8nXG4gICAgICAgICAgICAgICAgYWRkcmVzczogJHNjb3BlLmFkZHJlc3Nlc1swXVxuICAgICAgICAgICAgICAgIHN0YXRlOiAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLnN0YXRlXG4gICAgICAgICAgICAgICAgY2l0eTogJHJvb3RTY29wZS5HUklGRk8udXNlci5jaXR5XG4gICAgICAgICAgICAgICAgZmtpZHNob3A6ICRyb290U2NvcGUuR1JJRkZPLnVzZXIuZmtpZHNob3BcbiAgICAgICAgICAgIHNjaGVtYTogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6ICdma2lkc2hvcCdcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCdcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdMb2phJ1xuICAgICAgICAgICAgICAgICAgICBsaXN0OiAnaXRlbS52YWx1ZSBhcyBpdGVtLmxhYmVsIGZvciBpdGVtIGluIHNob3BzJ1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiA2XG4gICAgICAgICAgICAgICAgICAgIGF0dHI6IHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnQSBsb2phIMOpIG9icmlnYXTDs3JpYSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2ZldGNoJ1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY2hlY2tib3gnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnVmFpIGJ1c2Nhcj8nXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnM6IDZcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2Zvcm1wYXltZW50J1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2VsZWN0J1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0Zvcm1hIGRlIHBhZ2FtZW50bydcbiAgICAgICAgICAgICAgICAgICAgbGlzdDogJ2l0ZW0gYXMgaXRlbSBmb3IgaXRlbSBpbiBwYXltZW50cydcbiAgICAgICAgICAgICAgICAgICAgYXR0cjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZ0lmOiAnIWZvcm1TZXR0aW5ncy5kYXRhLmZldGNoJ1xuICAgICAgICAgICAgICAgICAgICBtc2dzOiByZXF1aXJlZDogJ0EgZm9ybWEgZGUgcGFnYW1lbnRvIMOpIG9icmlnYXTDs3JpYSdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2NoYW5nZSdcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ21vbmV5J1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0xBQkVMLkNIQU5HRS5GT1InXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnMCwwMCdcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogNlxuICAgICAgICAgICAgICAgICAgICBhdHRyOiBuZ0lmOiAnZm9ybVNldHRpbmdzLmRhdGEuZm9ybXBheW1lbnQgPT09IFxcJ0RpbmhlaXJvXFwnICYmICFmb3JtU2V0dGluZ3MuZGF0YS5mZXRjaCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnaHInXG4gICAgICAgICAgICAgICAgICAgIGF0dHI6ICduZy1pZic6ICchZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6ICdhZGRyZXNzJ1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2VsZWN0J1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0VuZGVyZcOnbyBkZSBlbnRyZWdhJ1xuICAgICAgICAgICAgICAgICAgICBsaXN0OiAnaXRlbSBhcyBpdGVtIGZvciBpdGVtIGluIGFkZHJlc3NlcydcbiAgICAgICAgICAgICAgICAgICAgYXR0cjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZ0lmOiAnIWZvcm1TZXR0aW5ncy5kYXRhLmZldGNoJ1xuICAgICAgICAgICAgICAgICAgICBtc2dzOiByZXF1aXJlZDogJ08gZW5kZXJlw6dvIGRlIGVudHJlZ2Egw6kgb2JyaWdhdMOzcmlvJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiAnYWRkcmVzczEnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnTm92byBlbmRlcmXDp28nXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnM6IDhcbiAgICAgICAgICAgICAgICAgICAgYXR0cjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZ0lmOiAnZm9ybVNldHRpbmdzLmRhdGEuYWRkcmVzcyA9PT0gXFwnT3V0cm8uLi5cXCcgJiYgIWZvcm1TZXR0aW5ncy5kYXRhLmZldGNoJ1xuICAgICAgICAgICAgICAgICAgICBtc2dzOiByZXF1aXJlZDogJ08gbm92byBlbmRlcmXDp28gw6kgb2JyaWdhdMOzcmlvJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiAnbnVtYmVyJ1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbnVtYmVyJ1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ07Dum1lcm8nXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnM6IDRcbiAgICAgICAgICAgICAgICAgICAgYXR0cjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZ0lmOiAnZm9ybVNldHRpbmdzLmRhdGEuYWRkcmVzcyA9PT0gXFwnT3V0cm8uLi5cXCcgJiYgIWZvcm1TZXR0aW5ncy5kYXRhLmZldGNoJ1xuICAgICAgICAgICAgICAgICAgICBtc2dzOiByZXF1aXJlZDogJ08gbsO6bWVybyDDqSBvYnJpZ2F0w7NyaW8nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6ICdjb21wbGVtZW50J1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0NvbXBsZW1lbnRvJ1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiA2XG4gICAgICAgICAgICAgICAgICAgIGF0dHI6IG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5hZGRyZXNzID09PSBcXCdPdXRyby4uLlxcJyAmJiAhZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6ICdkaXN0cmljdCdcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdCYWlycm8nXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnM6IDZcbiAgICAgICAgICAgICAgICAgICAgYXR0cjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZ0lmOiAnZm9ybVNldHRpbmdzLmRhdGEuYWRkcmVzcyA9PT0gXFwnT3V0cm8uLi5cXCcgJiYgIWZvcm1TZXR0aW5ncy5kYXRhLmZldGNoJ1xuICAgICAgICAgICAgICAgICAgICBtc2dzOiByZXF1aXJlZDogJ08gYmFpcnJvIMOpIG9icmlnYXTDs3JpbydcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ3N0YXRlJ1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2VsZWN0J1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0VzdGFkbydcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogNlxuICAgICAgICAgICAgICAgICAgICBsaXN0OiAnaXRlbS52YWx1ZSBhcyBpdGVtLmxhYmVsIGZvciBpdGVtIGluIHN0YXRlcydcbiAgICAgICAgICAgICAgICAgICAgYXR0cjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZ0lmOiAnZm9ybVNldHRpbmdzLmRhdGEuYWRkcmVzcyA9PT0gXFwnT3V0cm8uLi5cXCcgJiYgIWZvcm1TZXR0aW5ncy5kYXRhLmZldGNoJ1xuICAgICAgICAgICAgICAgICAgICBtc2dzOiByZXF1aXJlZDogJ1NlbGVjaW9uZSB1bSBlc3RhZG8nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6ICdjaXR5J1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2VsZWN0J1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0NpZGFkZSdcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogNlxuICAgICAgICAgICAgICAgICAgICBsaXN0OiAnaXRlbS52YWx1ZSBhcyBpdGVtLmxhYmVsIGZvciBpdGVtIGluIGNpdGllcydcbiAgICAgICAgICAgICAgICAgICAgYXR0cjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICBuZ0lmOiAnZm9ybVNldHRpbmdzLmRhdGEuYWRkcmVzcyA9PT0gXFwnT3V0cm8uLi5cXCcgJiYgIWZvcm1TZXR0aW5ncy5kYXRhLmZldGNoJ1xuICAgICAgICAgICAgICAgICAgICBtc2dzOiByZXF1aXJlZDogJ1NlbGVjaW9uZSB1bWEgY2lkYWRlJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgICAgIHN1Ym1pdDogKGRhdGEpIC0+XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlmICEkc2NvcGUuZm9ybS4kdmFsaWRcblxuICAgICAgICAgICAgICAgIG9yZGVyID1cbiAgICAgICAgICAgICAgICAgICAgZmtpZGNsaWVudDogJHJvb3RTY29wZS5HUklGRk8udXNlci5pZFxuICAgICAgICAgICAgICAgICAgICBmZXRjaDogZGF0YS5mZXRjaFxuICAgICAgICAgICAgICAgICAgICBzdWJ0b3RhbDogJHJvb3RTY29wZS5nci5jYXJ0LnRvdGFsKClcbiAgICAgICAgICAgICAgICAgICAgZmtpZHNob3A6IGRhdGEuZmtpZHNob3BcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdHM6IFtdXG5cbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2ggJHJvb3RTY29wZS5nci5jYXJ0Lml0ZW1zLCAoaXRlbSkgLT5cbiAgICAgICAgICAgICAgICAgICAgaWYgaXRlbS5jb3VudCA+IDBcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLnByb2R1Y3RzLnB1c2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZHByb2R1Y3Q6IGl0ZW0uaWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBma2lkc2hvcDogZGF0YS5ma2lkc2hvcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXR5OiBpdGVtLmNvdW50XG5cbiAgICAgICAgICAgICAgICBpZiAhZGF0YS5mZXRjaFxuICAgICAgICAgICAgICAgICAgICBvcmRlci5mb3JtcGF5bWVudCA9IGlmIGRhdGEuZm9ybXBheW1lbnQgdGhlbiBkYXRhLmZvcm1wYXltZW50IGVsc2UgdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgIG9yZGVyLmNoYW5nZSA9IGlmIGRhdGEuY2hhbmdlIHRoZW4gZGF0YS5jaGFuZ2UgZWxzZSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgZGF0YS5hZGRyZXNzID09ICdPdXRyby4uLidcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmFkZHJlc3MgPSBkYXRhLmFkZHJlc3MxXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5udW1iZXIgPSBkYXRhLm51bWJlclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuY29tcGxlbWVudCA9IGRhdGEuY29tcGxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuZGlzdHJpY3QgPSBkYXRhLmRpc3RyaWN0XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5jaXR5ID0gZGF0YS5jaXR5XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5zdGF0ZSA9IGRhdGEuc3RhdGVcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuYWRkcmVzcyA9ICRyb290U2NvcGUuR1JJRkZPLnVzZXIuYWRkcmVzc1xuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIubnVtYmVyID0gJHJvb3RTY29wZS5HUklGRk8udXNlci5udW1iZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmNvbXBsZW1lbnQgPSAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLmNvbXBsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmRpc3RyaWN0ID0gJHJvb3RTY29wZS5HUklGRk8udXNlci5kaXN0cmljdFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuY2l0eSA9ICRyb290U2NvcGUuR1JJRkZPLnVzZXIuY2l0eVxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuc3RhdGUgPSAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLnN0YXRlXG5cbiAgICAgICAgICAgICAgICAkZ3JSZXN0ZnVsLmNyZWF0ZVxuICAgICAgICAgICAgICAgICAgICBtb2R1bGU6ICdvcmRlcidcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnaW5zZXJ0J1xuICAgICAgICAgICAgICAgICAgICBwb3N0OiBvcmRlclxuICAgICAgICAgICAgICAgIC50aGVuIChyKSAtPlxuICAgICAgICAgICAgICAgICAgICBpZiByLnJlc3BvbnNlXG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5pc2hlZCA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5mb3JtLnJlc2V0KClcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuZ3IuY2FydC5jbGVhcigpXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydC5zaG93IHIuc3RhdHVzLCAnU2V1IHBlZGlkbyBmb2kgZW52aWFkbyBjb20gc3VjZXNzbywgdm9jw6ogc2Vyw6EgcmVkaXJlY2lvbmFkbyBwYXJhIGFjb21wYW5oYXIgc2V1IHBlZGlkby4nXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dCAoLT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gJHJvb3RTY29wZS5HUklGRk8uY3VyQWxpYXMgKyAnL3VzZXInXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgICAgICAgICApLCA1MDAwXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0LnNob3cgci5zdGF0dXMsIHIubWVzc2FnZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICAsIC0+XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0LnNob3cgJ2RhbmdlcicsICdFUlJPUi5GQVRBTCdcblxuICAgICAgICAkc2NvcGUuJHdhdGNoICdmb3JtU2V0dGluZ3MuZGF0YS5zdGF0ZScsIChlKSAtPlxuICAgICAgICAgICAgaWYgZVxuICAgICAgICAgICAgICAgIGlmICRzY29wZS5mb3JtU2V0dGluZ3MuZGF0YS5zdGF0ZVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0aWVzID0gW11cbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoICRjaWRhZGVFc3RhZG8uZ2V0LmNpZGFkZXMoJHNjb3BlLmZvcm1TZXR0aW5ncy5kYXRhLnN0YXRlKSwgKGMpIC0+XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0aWVzLnB1c2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogY1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBjXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jaXRpZXMgPSBbXVxuICAgICAgICAgICAgICAgIGlmICRzY29wZS5mb3JtU2V0dGluZ3MuZGF0YS5zdGF0ZSA9PSAnU1AnXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5mb3JtU2V0dGluZ3MuZGF0YS5jaXR5ID0gJ0l0YXBldmEnXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZm9ybVNldHRpbmdzLmRhdGEuY2l0eSA9IHVuZGVmaW5lZFxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICRzY29wZS5mb3JtU2V0dGluZ3MuZGF0YS5jaXR5ID0gdW5kZWZpbmVkXG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCAtPlxuICAgICAgICAgICAgJHJvb3RTY29wZS5nci5jYXJ0Lmxlbmd0aCgpXG4gICAgICAgICwgLT5cbiAgICAgICAgICAgIGNhcnRFbXB0eSgpIGlmICRyb290U2NvcGUuZ3IuY2FydC5sZW5ndGgoKSA9PSAwIGFuZCAhZmluaXNoZWRcblxuICAgICAgICAkc2NvcGUuJHdhdGNoICdmb3JtJywgKGZvcm0pIC0+XG4gICAgICAgICAgICAkcm9vdFNjb3BlLmZpbmlzaEZvcm0gPSBmb3JtXG4iXX0=