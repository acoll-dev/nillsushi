(function() {
  'use strict';
  angular.module('mainApp').controller('finishCtrl', ["$rootScope", "$scope", "$localStorage", "$grRestful", "$grModal", "$grAlert", "$cidadeEstado", "$timeout", function($rootScope, $scope, $localStorage, $grRestful, $grModal, $grAlert, $cidadeEstado, $timeout) {
    var alert, cartEmpty, finished;
    alert = $grAlert["new"]();
    finished = false;
    cartEmpty = function(url) {
      alert.show('info', 'Sua lista de pedidos está vazia, você será redirecionado!');
      return $timeout(function() {
        return location.href = $rootScope.GRIFFO.curAlias + '/' + (url ? url : '');
      }, 5000);
    };
    if ($rootScope.gr.cart.length() === 0) {
      return cartEmpty();
    } else {
      $rootScope.gr.title = {
        icon: 'fa fa-fw fa-check',
        text: 'Finalizar pedido'
      };
      $scope.payments = ['Dinheiro', 'Cartão de Crédito/Débito'];
      $scope.addresses = [$rootScope.GRIFFO.user.address + ', ' + $rootScope.GRIFFO.user.number + ($rootScope.GRIFFO.user.complement ? ', ' + $rootScope.GRIFFO.user.complement : '') + ', ' + $rootScope.GRIFFO.user.district, 'Outro...'];
      $scope.shops = [];
      $grRestful.find({
        module: 'shop',
        action: 'select'
      }).then(function(r) {
        if (r.response) {
          return $scope.shops = r.response;
        }
      });
      $scope.states = [];
      angular.forEach($cidadeEstado.get.estados(), function(e) {
        $scope.states.push({
          value: e[0],
          label: e[1]
        });
      });
      delete $localStorage.griffo_cart_ready;
      $scope.formSettings = {
        data: {
          status: 0,
          date: new Date,
          time: moment(new Date).format("HH:mm"),
          formpayment: 'Dinheiro',
          address: $scope.addresses[0],
          state: $rootScope.GRIFFO.user.state,
          city: $rootScope.GRIFFO.user.city,
          fkidshop: $rootScope.GRIFFO.user.fkidshop
        },
        schema: [
          {
            property: 'fkidshop',
            type: 'select',
            label: 'Loja',
            list: 'item.value as item.label for item in shops',
            columns: 12,
            attr: {
              required: true,
              ngShow: 'shops.length > 2'
            },
            msgs: {
              required: 'A loja é obrigatória'
            }
          }, {
            property: 'date',
            type: 'date',
            label: 'Data do pedido',
            columns: 6,
            attr: {
              required: true
            },
            msgs: {
              required: 'A data é obrigatória'
            }
          }, {
            property: 'time',
            type: 'text',
            label: 'Hora do pedido',
            columns: 6,
            attr: {
              required: true,
              grMask: "'99:99'"
            },
            msgs: {
              required: 'A hora é obrigatória'
            }
          }, {
            property: 'fetch',
            type: 'checkbox',
            label: 'Vai buscar?',
            columns: 12
          }, {
            property: 'formpayment',
            type: 'select',
            label: 'Forma de pagamento',
            list: 'item as item for item in payments',
            attr: {
              required: true,
              ngIf: '!formSettings.data.fetch'
            },
            msgs: {
              required: 'A forma de pagamento é obrigatória'
            }
          }, {
            property: 'change',
            type: 'money',
            label: 'LABEL.CHANGE.FOR',
            placeholder: '0,00',
            columns: 6,
            attr: {
              ngIf: 'formSettings.data.formpayment === \'Dinheiro\' && !formSettings.data.fetch'
            }
          }, {
            type: 'hr',
            attr: {
              'ng-if': '!formSettings.data.fetch'
            }
          }, {
            property: 'address',
            type: 'select',
            label: 'Endereço de entrega',
            list: 'item as item for item in addresses',
            attr: {
              required: true,
              ngIf: '!formSettings.data.fetch'
            },
            msgs: {
              required: 'O endereço de entrega é obrigatório'
            }
          }, {
            property: 'address1',
            label: 'Novo endereço',
            columns: 8,
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'O novo endereço é obrigatório'
            }
          }, {
            property: 'number',
            type: 'number',
            label: 'Número',
            columns: 4,
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'O número é obrigatório'
            }
          }, {
            property: 'complement',
            label: 'Complemento',
            columns: 6,
            attr: {
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            }
          }, {
            property: 'district',
            label: 'Bairro',
            columns: 6,
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'O bairro é obrigatório'
            }
          }, {
            property: 'state',
            type: 'select',
            label: 'Estado',
            columns: 6,
            list: 'item.value as item.label for item in states',
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'Selecione um estado'
            }
          }, {
            property: 'city',
            type: 'select',
            label: 'Cidade',
            columns: 6,
            list: 'item.value as item.label for item in cities',
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'Selecione uma cidade'
            }
          }
        ],
        submit: function(data) {
          var order, time;
          if (!$scope.form.$valid) {
            return;
          }
          time = data.time.split(':');
          order = {
            fkidclient: $rootScope.GRIFFO.user.id,
            fetch: data.fetch,
            subtotal: $rootScope.gr.cart.total(),
            fkidshop: data.fkidshop,
            created: moment(data.date).hour(time[0]).minute(time[1]).second(0).format('YYYY-MM-DD HH:mm:ss'),
            products: []
          };
          angular.forEach($rootScope.gr.cart.items, function(item) {
            if (item.count > 0) {
              return order.products.push({
                idproduct: item.id,
                fkidshop: data.fkidshop,
                quantity: item.count
              });
            }
          });
          if (!data.fetch) {
            order.formpayment = data.formpayment ? data.formpayment : void 0;
            order.change = data.change ? data.change : void 0;
            if (data.address === 'Outro...') {
              order.address = data.address1;
              order.number = data.number;
              order.complement = data.complement;
              order.district = data.district;
              order.city = data.city;
              order.state = data.state;
            } else {
              order.address = $rootScope.GRIFFO.user.address;
              order.number = $rootScope.GRIFFO.user.number;
              order.complement = $rootScope.GRIFFO.user.complement;
              order.district = $rootScope.GRIFFO.user.district;
              order.city = $rootScope.GRIFFO.user.city;
              order.state = $rootScope.GRIFFO.user.state;
            }
          }
          return $grRestful.create({
            module: 'order',
            action: 'insert',
            post: order
          }).then(function(r) {
            if (r.response) {
              finished = true;
              $scope.form.reset();
              $rootScope.gr.cart.clear();
              alert.show(r.status, 'Seu pedido foi enviado com sucesso, você será redirecionado para acompanhar seu pedido.');
              $timeout((function() {
                location.href = $rootScope.GRIFFO.curAlias + '/user';
              }), 5000);
            } else {
              alert.show(r.status, r.message);
            }
          }, function() {
            return alert.show('danger', 'ERROR.FATAL');
          });
        }
      };
      $scope.$watch('formSettings.data.state', function(e) {
        if (e) {
          if ($scope.formSettings.data.state) {
            $scope.cities = [];
            angular.forEach($cidadeEstado.get.cidades($scope.formSettings.data.state), function(c) {
              $scope.cities.push({
                value: c,
                label: c
              });
            });
          } else {
            $scope.cities = [];
          }
          if ($scope.formSettings.data.state === 'SP') {
            return $scope.formSettings.data.city = 'Itapeva';
          } else {
            return $scope.formSettings.data.city = void 0;
          }
        } else {
          return $scope.formSettings.data.city = void 0;
        }
      });
      $scope.$watch(function() {
        return $rootScope.gr.cart.length();
      }, function() {
        if ($rootScope.gr.cart.length() === 0 && !finished) {
          return cartEmpty();
        }
      });
      return $scope.$watch('form', function(form) {
        return $rootScope.finishForm = form;
      });
    }
  }]);

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsaWVudC9sYXllcnMvd2Vic2l0ZS90ZW1wbGF0ZXMvY3JhYi9jb2ZmZWUvY29udHJvbGxlcnMvZmluaXNoQ3RybC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFBQTtFQUNBLE9BQU8sQ0FBQyxNQUFSLENBQWUsU0FBZixDQUF5QixDQUFDLFVBQTFCLENBQXFDLFlBQXJDLEVBQW1ELFNBQUMsVUFBRCxFQUFhLE1BQWIsRUFBcUIsYUFBckIsRUFBb0MsVUFBcEMsRUFBZ0QsUUFBaEQsRUFBMEQsUUFBMUQsRUFBb0UsYUFBcEUsRUFBbUYsUUFBbkY7QUFFL0MsUUFBQTtJQUFBLEtBQUEsR0FBUSxRQUFRLENBQUMsS0FBRCxDQUFSLENBQUE7SUFDUixRQUFBLEdBQVc7SUFFWCxTQUFBLEdBQVksU0FBQyxHQUFEO01BQ1IsS0FBSyxDQUFDLElBQU4sQ0FBVyxNQUFYLEVBQW1CLDJEQUFuQjthQUNBLFFBQUEsQ0FBUyxTQUFBO2VBQ0wsUUFBUSxDQUFDLElBQVQsR0FBZ0IsVUFBVSxDQUFDLE1BQU0sQ0FBQyxRQUFsQixHQUE2QixHQUE3QixHQUFtQyxDQUFJLEdBQUgsR0FBWSxHQUFaLEdBQXFCLEVBQXRCO01BRDlDLENBQVQsRUFFRSxJQUZGO0lBRlE7SUFNWixJQUFHLFVBQVUsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQW5CLENBQUEsQ0FBQSxLQUErQixDQUFsQzthQUNJLFNBQUEsQ0FBQSxFQURKO0tBQUEsTUFBQTtNQUdJLFVBQVUsQ0FBQyxFQUFFLENBQUMsS0FBZCxHQUNJO1FBQUEsSUFBQSxFQUFNLG1CQUFOO1FBQ0EsSUFBQSxFQUFNLGtCQUROOztNQUVKLE1BQU0sQ0FBQyxRQUFQLEdBQWtCLENBQ2QsVUFEYyxFQUVkLDBCQUZjO01BSWxCLE1BQU0sQ0FBQyxTQUFQLEdBQW1CLENBQ2YsVUFBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBdkIsR0FBaUMsSUFBakMsR0FBd0MsVUFBVSxDQUFDLE1BQU0sQ0FB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QUNWLFVBQVUsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQW5CLENBQUE7TUFEVSxDQUFkLEVBRUUsU0FBQTtRQUNFLElBQWUsVUFBVSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBbkIsQ0FBQSxDQUFBLEtBQStCLENBQS9CLElBQXFDLENBQUMsUUFBckQ7aUJBQUEsU0FBQSxDQUFBLEVBQUE7O01BREYsQ0FGRjthQUtBLE1BQU0sQ0FBQyxNQUFQLENBQWMsTUFBZCxFQUFzQixTQUFDLElBQUQ7ZUFDbEIsVUFBVSxDQUFDLFVBQVgsR0FBd0I7TUFETixDQUF0QixFQWxQSjs7RUFYK0MsQ0FBbkQ7QUFEQSIsImZpbGUiOiJjbGllbnQvbGF5ZXJzL3dlYnNpdGUvdGVtcGxhdGVzL2NyYWIvanMvY29udHJvbGxlcnMvZmluaXNoQ3RybC5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuYW5ndWxhci5tb2R1bGUoJ21haW5BcHAnKS5jb250cm9sbGVyICdmaW5pc2hDdHJsJywgKCRyb290U2NvcGUsICRzY29wZSwgJGxvY2FsU3RvcmFnZSwgJGdyUmVzdGZ1bCwgJGdyTW9kYWwsICRnckFsZXJ0LCAkY2lkYWRlRXN0YWRvLCAkdGltZW91dCkgLT5cblxuICAgIGFsZXJ0ID0gJGdyQWxlcnQubmV3KClcbiAgICBmaW5pc2hlZCA9IGZhbHNlXG5cbiAgICBjYXJ0RW1wdHkgPSAodXJsKSAtPlxuICAgICAgICBhbGVydC5zaG93ICdpbmZvJywgJ1N1YSBsaXN0YSBkZSBwZWRpZG9zIGVzdMOhIHZhemlhLCB2b2PDqiBzZXLDoSByZWRpcmVjaW9uYWRvISdcbiAgICAgICAgJHRpbWVvdXQgLT5cbiAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSAkcm9vdFNjb3BlLkdSSUZGTy5jdXJBbGlhcyArICcvJyArIChpZiB1cmwgdGhlbiB1cmwgZWxzZSAnJylcbiAgICAgICAgLCA1MDAwXG5cbiAgICBpZiAkcm9vdFNjb3BlLmdyLmNhcnQubGVuZ3RoKCkgPT0gMFxuICAgICAgICBjYXJ0RW1wdHkoKVxuICAgIGVsc2VcbiAgICAgICAgJHJvb3RTY29wZS5nci50aXRsZSA9XG4gICAgICAgICAgICBpY29uOiAnZmEgZmEtZncgZmEtY2hlY2snXG4gICAgICAgICAgICB0ZXh0OiAnRmluYWxpemFyIHBlZGlkbydcbiAgICAgICAgJHNjb3BlLnBheW1lbnRzID0gW1xuICAgICAgICAgICAgJ0RpbmhlaXJvJ1xuICAgICAgICAgICAgJ0NhcnTDo28gZGUgQ3LDqWRpdG8vRMOpYml0bydcbiAgICAgICAgXVxuICAgICAgICAkc2NvcGUuYWRkcmVzc2VzID0gW1xuICAgICAgICAgICAgJHJvb3RTY29wZS5HUklGRk8udXNlci5hZGRyZXNzICsgJywgJyArICRyb290U2NvcGUuR1JJRkZPLnVzZXIubnVtYmVyICsgKGlmICRyb290U2NvcGUuR1JJRkZPLnVzZXIuY29tcGxlbWVudCB0aGVuICcsICcgKyAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLmNvbXBsZW1lbnQgZWxzZSAnJykgKyAnLCAnICsgJHJvb3RTY29wZS5HUklGRk8udXNlci5kaXN0cmljdFxuICAgICAgICAgICAgJ091dHJvLi4uJ1xuICAgICAgICBdXG4gICAgICAgICRzY29wZS5zaG9wcyA9IFtdXG5cbiAgICAgICAgJGdyUmVzdGZ1bC5maW5kKFxuICAgICAgICAgICAgbW9kdWxlOiAnc2hvcCdcbiAgICAgICAgICAgIGFjdGlvbjogJ3NlbGVjdCcpLnRoZW4gKHIpIC0+XG4gICAgICAgICAgICBpZiByLnJlc3BvbnNlXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNob3BzID0gci5yZXNwb25zZVxuXG4gICAgICAgICRzY29wZS5zdGF0ZXMgPSBbXVxuXG4gICAgICAgIGFuZ3VsYXIuZm9yRWFjaCAkY2lkYWRlRXN0YWRvLmdldC5lc3RhZG9zKCksIChlKSAtPlxuICAgICAgICAgICAgJHNjb3BlLnN0YXRlcy5wdXNoXG4gICAgICAgICAgICAgICAgdmFsdWU6IGVbMF1cbiAgICAgICAgICAgICAgICBsYWJlbDogZVsxXVxuICAgICAgICAgICAgcmV0dXJuXG5cbiAgICAgICAgZGVsZXRlICRsb2NhbFN0b3JhZ2UuZ3JpZmZvX2NhcnRfcmVhZHlcblxuICAgICAgICAkc2NvcGUuZm9ybVNldHRpbmdzID1cbiAgICAgICAgICAgIGRhdGE6XG4gICAgICAgICAgICAgICAgc3RhdHVzOiAwXG4gICAgICAgICAgICAgICAgZGF0ZTogbmV3IERhdGVcbiAgICAgICAgICAgICAgICB0aW1lOiBtb21lbnQobmV3IERhdGUpLmZvcm1hdChcIkhIOm1tXCIpXG4gICAgICAgICAgICAgICAgZm9ybXBheW1lbnQ6ICdEaW5oZWlybydcbiAgICAgICAgICAgICAgICBhZGRyZXNzOiAkc2NvcGUuYWRkcmVzc2VzWzBdXG4gICAgICAgICAgICAgICAgc3RhdGU6ICRyb290U2NvcGUuR1JJRkZPLnVzZXIuc3RhdGVcbiAgICAgICAgICAgICAgICBjaXR5OiAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLmNpdHlcbiAgICAgICAgICAgICAgICBma2lkc2hvcDogJHJvb3RTY29wZS5HUklGRk8udXNlci5ma2lkc2hvcFxuICAgICAgICAgICAgc2NoZW1hOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2ZraWRzaG9wJ1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2VsZWN0J1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0xvamEnXG4gICAgICAgICAgICAgICAgICAgIGxpc3Q6ICdpdGVtLnZhbHVlIGFzIGl0ZW0ubGFiZWwgZm9yIGl0ZW0gaW4gc2hvcHMnXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnM6IDEyXG4gICAgICAgICAgICAgICAgICAgIGF0dHI6IHJlcXVpcmVkOiB0cnVlLCBuZ1Nob3c6ICdzaG9wcy5sZW5ndGggPiAyJ1xuICAgICAgICAgICAgICAgICAgICBtc2dzOiByZXF1aXJlZDogJ0EgbG9qYSDDqSBvYnJpZ2F0w7NyaWEnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiAnZGF0ZSdcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICdkYXRlJ1xuICAgICAgICAgICAgICAgICAgbGFiZWw6ICdEYXRhIGRvIHBlZGlkbydcbiAgICAgICAgICAgICAgICAgIGNvbHVtbnM6IDZcbiAgICAgICAgICAgICAgICAgIGF0dHI6IHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICAgICAgICBtc2dzOiByZXF1aXJlZDogJ0EgZGF0YSDDqSBvYnJpZ2F0w7NyaWEnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiAndGltZSdcbiAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0J1xuICAgICAgICAgICAgICAgICAgbGFiZWw6ICdIb3JhIGRvIHBlZGlkbydcbiAgICAgICAgICAgICAgICAgIGNvbHVtbnM6IDZcbiAgICAgICAgICAgICAgICAgIGF0dHI6IHJlcXVpcmVkOiB0cnVlLCBnck1hc2s6IFwiJzk5Ojk5J1wiXG4gICAgICAgICAgICAgICAgICBtc2dzOiByZXF1aXJlZDogJ0EgaG9yYSDDqSBvYnJpZ2F0w7NyaWEnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6ICdmZXRjaCdcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2NoZWNrYm94J1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ1ZhaSBidXNjYXI/J1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiAxMlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiAnZm9ybXBheW1lbnQnXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnRm9ybWEgZGUgcGFnYW1lbnRvJ1xuICAgICAgICAgICAgICAgICAgICBsaXN0OiAnaXRlbSBhcyBpdGVtIGZvciBpdGVtIGluIHBheW1lbnRzJ1xuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICchZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnQSBmb3JtYSBkZSBwYWdhbWVudG8gw6kgb2JyaWdhdMOzcmlhJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiAnY2hhbmdlJ1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbW9uZXknXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnTEFCRUwuQ0hBTkdFLkZPUidcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICcwLDAwJ1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiA2XG4gICAgICAgICAgICAgICAgICAgIGF0dHI6IG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5mb3JtcGF5bWVudCA9PT0gXFwnRGluaGVpcm9cXCcgJiYgIWZvcm1TZXR0aW5ncy5kYXRhLmZldGNoJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdocidcbiAgICAgICAgICAgICAgICAgICAgYXR0cjogJ25nLWlmJzogJyFmb3JtU2V0dGluZ3MuZGF0YS5mZXRjaCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2FkZHJlc3MnXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnRW5kZXJlw6dvIGRlIGVudHJlZ2EnXG4gICAgICAgICAgICAgICAgICAgIGxpc3Q6ICdpdGVtIGFzIGl0ZW0gZm9yIGl0ZW0gaW4gYWRkcmVzc2VzJ1xuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICchZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnTyBlbmRlcmXDp28gZGUgZW50cmVnYSDDqSBvYnJpZ2F0w7NyaW8nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6ICdhZGRyZXNzMSdcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdOb3ZvIGVuZGVyZcOnbydcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogOFxuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5hZGRyZXNzID09PSBcXCdPdXRyby4uLlxcJyAmJiAhZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnTyBub3ZvIGVuZGVyZcOnbyDDqSBvYnJpZ2F0w7NyaW8nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6ICdudW1iZXInXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnTsO6bWVybydcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogNFxuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5hZGRyZXNzID09PSBcXCdPdXRyby4uLlxcJyAmJiAhZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnTyBuw7ptZXJvIMOpIG9icmlnYXTDs3JpbydcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2NvbXBsZW1lbnQnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnQ29tcGxlbWVudG8nXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnM6IDZcbiAgICAgICAgICAgICAgICAgICAgYXR0cjogbmdJZjogJ2Zvcm1TZXR0aW5ncy5kYXRhLmFkZHJlc3MgPT09IFxcJ091dHJvLi4uXFwnICYmICFmb3JtU2V0dGluZ3MuZGF0YS5mZXRjaCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2Rpc3RyaWN0J1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0JhaXJybydcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogNlxuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5hZGRyZXNzID09PSBcXCdPdXRyby4uLlxcJyAmJiAhZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnTyBiYWlycm8gw6kgb2JyaWdhdMOzcmlvJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiAnc3RhdGUnXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnRXN0YWRvJ1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiA2XG4gICAgICAgICAgICAgICAgICAgIGxpc3Q6ICdpdGVtLnZhbHVlIGFzIGl0ZW0ubGFiZWwgZm9yIGl0ZW0gaW4gc3RhdGVzJ1xuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5hZGRyZXNzID09PSBcXCdPdXRyby4uLlxcJyAmJiAhZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnU2VsZWNpb25lIHVtIGVzdGFkbydcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2NpdHknXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnQ2lkYWRlJ1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiA2XG4gICAgICAgICAgICAgICAgICAgIGxpc3Q6ICdpdGVtLnZhbHVlIGFzIGl0ZW0ubGFiZWwgZm9yIGl0ZW0gaW4gY2l0aWVzJ1xuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5hZGRyZXNzID09PSBcXCdPdXRyby4uLlxcJyAmJiAhZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnU2VsZWNpb25lIHVtYSBjaWRhZGUnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgICAgc3VibWl0OiAoZGF0YSkgLT5cbiAgICAgICAgICAgICAgICByZXR1cm4gaWYgISRzY29wZS5mb3JtLiR2YWxpZFxuICAgICAgICAgICAgICAgIHRpbWUgPSBkYXRhLnRpbWUuc3BsaXQoJzonKVxuICAgICAgICAgICAgICAgIG9yZGVyID1cbiAgICAgICAgICAgICAgICAgICAgZmtpZGNsaWVudDogJHJvb3RTY29wZS5HUklGRk8udXNlci5pZFxuICAgICAgICAgICAgICAgICAgICBmZXRjaDogZGF0YS5mZXRjaFxuICAgICAgICAgICAgICAgICAgICBzdWJ0b3RhbDogJHJvb3RTY29wZS5nci5jYXJ0LnRvdGFsKClcbiAgICAgICAgICAgICAgICAgICAgZmtpZHNob3A6IGRhdGEuZmtpZHNob3BcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZDogbW9tZW50KGRhdGEuZGF0ZSkuaG91cih0aW1lWzBdKS5taW51dGUodGltZVsxXSkuc2Vjb25kKDApLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzOiBbXVxuXG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoICRyb290U2NvcGUuZ3IuY2FydC5pdGVtcywgKGl0ZW0pIC0+XG4gICAgICAgICAgICAgICAgICAgIGlmIGl0ZW0uY291bnQgPiAwXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5wcm9kdWN0cy5wdXNoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRwcm9kdWN0OiBpdGVtLmlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmtpZHNob3A6IGRhdGEuZmtpZHNob3BcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogaXRlbS5jb3VudFxuXG4gICAgICAgICAgICAgICAgaWYgIWRhdGEuZmV0Y2hcbiAgICAgICAgICAgICAgICAgICAgb3JkZXIuZm9ybXBheW1lbnQgPSBpZiBkYXRhLmZvcm1wYXltZW50IHRoZW4gZGF0YS5mb3JtcGF5bWVudCBlbHNlIHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICBvcmRlci5jaGFuZ2UgPSBpZiBkYXRhLmNoYW5nZSB0aGVuIGRhdGEuY2hhbmdlIGVsc2UgdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgIGlmIGRhdGEuYWRkcmVzcyA9PSAnT3V0cm8uLi4nXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5hZGRyZXNzID0gZGF0YS5hZGRyZXNzMVxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIubnVtYmVyID0gZGF0YS5udW1iZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmNvbXBsZW1lbnQgPSBkYXRhLmNvbXBsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmRpc3RyaWN0ID0gZGF0YS5kaXN0cmljdFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuY2l0eSA9IGRhdGEuY2l0eVxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuc3RhdGUgPSBkYXRhLnN0YXRlXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmFkZHJlc3MgPSAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLmFkZHJlc3NcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLm51bWJlciA9ICRyb290U2NvcGUuR1JJRkZPLnVzZXIubnVtYmVyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5jb21wbGVtZW50ID0gJHJvb3RTY29wZS5HUklGRk8udXNlci5jb21wbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5kaXN0cmljdCA9ICRyb290U2NvcGUuR1JJRkZPLnVzZXIuZGlzdHJpY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmNpdHkgPSAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLmNpdHlcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLnN0YXRlID0gJHJvb3RTY29wZS5HUklGRk8udXNlci5zdGF0ZVxuXG4gICAgICAgICAgICAgICAgJGdyUmVzdGZ1bC5jcmVhdGVcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlOiAnb3JkZXInXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ2luc2VydCdcbiAgICAgICAgICAgICAgICAgICAgcG9zdDogb3JkZXJcbiAgICAgICAgICAgICAgICAudGhlbiAocikgLT5cbiAgICAgICAgICAgICAgICAgICAgaWYgci5yZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICAgICAgZmluaXNoZWQgPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZm9ybS5yZXNldCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdyLmNhcnQuY2xlYXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQuc2hvdyByLnN0YXR1cywgJ1NldSBwZWRpZG8gZm9pIGVudmlhZG8gY29tIHN1Y2Vzc28sIHZvY8OqIHNlcsOhIHJlZGlyZWNpb25hZG8gcGFyYSBhY29tcGFuaGFyIHNldSBwZWRpZG8uJ1xuICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQgKC0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9ICRyb290U2NvcGUuR1JJRkZPLmN1ckFsaWFzICsgJy91c2VyJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgICAgICAgICAgICAgKSwgNTAwMFxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydC5zaG93IHIuc3RhdHVzLCByLm1lc3NhZ2VcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgLCAtPlxuICAgICAgICAgICAgICAgICAgICBhbGVydC5zaG93ICdkYW5nZXInLCAnRVJST1IuRkFUQUwnXG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCAnZm9ybVNldHRpbmdzLmRhdGEuc3RhdGUnLCAoZSkgLT5cbiAgICAgICAgICAgIGlmIGVcbiAgICAgICAgICAgICAgICBpZiAkc2NvcGUuZm9ybVNldHRpbmdzLmRhdGEuc3RhdGVcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdGllcyA9IFtdXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCAkY2lkYWRlRXN0YWRvLmdldC5jaWRhZGVzKCRzY29wZS5mb3JtU2V0dGluZ3MuZGF0YS5zdGF0ZSksIChjKSAtPlxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdGllcy5wdXNoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogY1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0aWVzID0gW11cbiAgICAgICAgICAgICAgICBpZiAkc2NvcGUuZm9ybVNldHRpbmdzLmRhdGEuc3RhdGUgPT0gJ1NQJ1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZm9ybVNldHRpbmdzLmRhdGEuY2l0eSA9ICdJdGFwZXZhJ1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZvcm1TZXR0aW5ncy5kYXRhLmNpdHkgPSB1bmRlZmluZWRcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAkc2NvcGUuZm9ybVNldHRpbmdzLmRhdGEuY2l0eSA9IHVuZGVmaW5lZFxuXG4gICAgICAgICRzY29wZS4kd2F0Y2ggLT5cbiAgICAgICAgICAgICRyb290U2NvcGUuZ3IuY2FydC5sZW5ndGgoKVxuICAgICAgICAsIC0+XG4gICAgICAgICAgICBjYXJ0RW1wdHkoKSBpZiAkcm9vdFNjb3BlLmdyLmNhcnQubGVuZ3RoKCkgPT0gMCBhbmQgIWZpbmlzaGVkXG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCAnZm9ybScsIChmb3JtKSAtPlxuICAgICAgICAgICAgJHJvb3RTY29wZS5maW5pc2hGb3JtID0gZm9ybVxuIl19