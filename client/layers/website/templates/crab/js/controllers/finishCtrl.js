(function() {
  'use strict';
  angular.module('mainApp').controller('finishCtrl', ["$rootScope", "$scope", "$localStorage", "$grRestful", "$grModal", "$grAlert", "$cidadeEstado", "$timeout", function($rootScope, $scope, $localStorage, $grRestful, $grModal, $grAlert, $cidadeEstado, $timeout) {
    var alert, cartEmpty, finished;
    alert = $grAlert["new"]();
    finished = false;
    cartEmpty = function(url) {
      alert.show('info', 'Sua lista de pedidos está vazia, você será redirecionado!');
      return $timeout(function() {
        return location.href = $rootScope.GRIFFO.curAlias + '/' + (url ? url : '');
      }, 5000);
    };
    if ($rootScope.gr.cart.length() === 0) {
      return cartEmpty();
    } else {
      $rootScope.gr.title = {
        icon: 'fa fa-fw fa-check',
        text: 'Finalizar pedido'
      };
      $scope.payments = ['Dinheiro', 'Cartão de Crédito/Débito'];
      $scope.addresses = [$rootScope.GRIFFO.user.address + ', ' + $rootScope.GRIFFO.user.number + ($rootScope.GRIFFO.user.complement ? ', ' + $rootScope.GRIFFO.user.complement : '') + ', ' + $rootScope.GRIFFO.user.district, 'Outro...'];
      $scope.shops = [];
      $grRestful.find({
        module: 'shop',
        action: 'select'
      }).then(function(r) {
        if (r.response) {
          return $scope.shops = r.response;
        }
      });
      $scope.states = [];
      angular.forEach($cidadeEstado.get.estados(), function(e) {
        $scope.states.push({
          value: e[0],
          label: e[1]
        });
      });
      delete $localStorage.griffo_cart_ready;
      $scope.formSettings = {
        data: {
          status: 0,
          date: new Date,
          time: '00:00',
          formpayment: 'Dinheiro',
          address: $scope.addresses[0],
          state: $rootScope.GRIFFO.user.state,
          city: $rootScope.GRIFFO.user.city,
          fkidshop: $rootScope.GRIFFO.user.fkidshop
        },
        schema: [
          {
            property: 'fkidshop',
            type: 'select',
            label: 'Loja',
            list: 'item.value as item.label for item in shops',
            columns: 12,
            attr: {
              required: true,
              ngShow: 'shops.length > 2'
            },
            msgs: {
              required: 'A loja é obrigatória'
            }
          }, {
            property: 'date',
            type: 'date',
            label: 'Data do pedido',
            columns: 6,
            attr: {
              required: true
            },
            msgs: {
              required: 'A data é obrigatória'
            }
          }, {
            property: 'fetch',
            type: 'checkbox',
            label: 'Vai buscar?',
            columns: 6
          }, {
            property: 'formpayment',
            type: 'select',
            label: 'Forma de pagamento',
            list: 'item as item for item in payments',
            attr: {
              required: true,
              ngIf: '!formSettings.data.fetch'
            },
            msgs: {
              required: 'A forma de pagamento é obrigatória'
            }
          }, {
            property: 'change',
            type: 'money',
            label: 'LABEL.CHANGE.FOR',
            placeholder: '0,00',
            columns: 6,
            attr: {
              ngIf: 'formSettings.data.formpayment === \'Dinheiro\' && !formSettings.data.fetch'
            }
          }, {
            type: 'hr',
            attr: {
              'ng-if': '!formSettings.data.fetch'
            }
          }, {
            property: 'address',
            type: 'select',
            label: 'Endereço de entrega',
            list: 'item as item for item in addresses',
            attr: {
              required: true,
              ngIf: '!formSettings.data.fetch'
            },
            msgs: {
              required: 'O endereço de entrega é obrigatório'
            }
          }, {
            property: 'address1',
            label: 'Novo endereço',
            columns: 8,
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'O novo endereço é obrigatório'
            }
          }, {
            property: 'number',
            type: 'number',
            label: 'Número',
            columns: 4,
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'O número é obrigatório'
            }
          }, {
            property: 'complement',
            label: 'Complemento',
            columns: 6,
            attr: {
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            }
          }, {
            property: 'district',
            label: 'Bairro',
            columns: 6,
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'O bairro é obrigatório'
            }
          }, {
            property: 'state',
            type: 'select',
            label: 'Estado',
            columns: 6,
            list: 'item.value as item.label for item in states',
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'Selecione um estado'
            }
          }, {
            property: 'city',
            type: 'select',
            label: 'Cidade',
            columns: 6,
            list: 'item.value as item.label for item in cities',
            attr: {
              required: true,
              ngIf: 'formSettings.data.address === \'Outro...\' && !formSettings.data.fetch'
            },
            msgs: {
              required: 'Selecione uma cidade'
            }
          }
        ],
        submit: function(data) {
          var order, time;
          if (!$scope.form.$valid) {
            return;
          }
          time = data.time.split(':');
          order = {
            fkidclient: $rootScope.GRIFFO.user.id,
            fetch: data.fetch,
            subtotal: $rootScope.gr.cart.total(),
            fkidshop: data.fkidshop,
            created: moment(data.date).hour(time[0]).minute(time[1]).second(0).format('YYYY-MM-DD HH:mm:ss'),
            products: []
          };
          angular.forEach($rootScope.gr.cart.items, function(item) {
            if (item.count > 0) {
              return order.products.push({
                idproduct: item.id,
                fkidshop: data.fkidshop,
                quantity: item.count
              });
            }
          });
          if (!data.fetch) {
            order.formpayment = data.formpayment ? data.formpayment : void 0;
            order.change = data.change ? data.change : void 0;
            if (data.address === 'Outro...') {
              order.address = data.address1;
              order.number = data.number;
              order.complement = data.complement;
              order.district = data.district;
              order.city = data.city;
              order.state = data.state;
            } else {
              order.address = $rootScope.GRIFFO.user.address;
              order.number = $rootScope.GRIFFO.user.number;
              order.complement = $rootScope.GRIFFO.user.complement;
              order.district = $rootScope.GRIFFO.user.district;
              order.city = $rootScope.GRIFFO.user.city;
              order.state = $rootScope.GRIFFO.user.state;
            }
          }
          return $grRestful.create({
            module: 'order',
            action: 'insert',
            post: order
          }).then(function(r) {
            if (r.response) {
              finished = true;
              $scope.form.reset();
              $rootScope.gr.cart.clear();
              alert.show(r.status, 'Seu pedido foi enviado com sucesso, você será redirecionado para acompanhar seu pedido.');
              $timeout((function() {
                location.href = $rootScope.GRIFFO.curAlias + '/user';
              }), 5000);
            } else {
              alert.show(r.status, r.message);
            }
          }, function() {
            return alert.show('danger', 'ERROR.FATAL');
          });
        }
      };
      $scope.$watch('formSettings.data.state', function(e) {
        if (e) {
          if ($scope.formSettings.data.state) {
            $scope.cities = [];
            angular.forEach($cidadeEstado.get.cidades($scope.formSettings.data.state), function(c) {
              $scope.cities.push({
                value: c,
                label: c
              });
            });
          } else {
            $scope.cities = [];
          }
          if ($scope.formSettings.data.state === 'SP') {
            return $scope.formSettings.data.city = 'Itapeva';
          } else {
            return $scope.formSettings.data.city = void 0;
          }
        } else {
          return $scope.formSettings.data.city = void 0;
        }
      });
      $scope.$watch(function() {
        return $rootScope.gr.cart.length();
      }, function() {
        if ($rootScope.gr.cart.length() === 0 && !finished) {
          return cartEmpty();
        }
      });
      return $scope.$watch('form', function(form) {
        return $rootScope.finishForm = form;
      });
    }
  }]);

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsaWVudC9sYXllcnMvd2Vic2l0ZS90ZW1wbGF0ZXMvY3JhYi9jb2ZmZWUvY29udHJvbGxlcnMvZmluaXNoQ3RybC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFBQTtFQUNBLE9BQU8sQ0FBQyxNQUFSLENBQWUsU0FBZixDQUF5QixDQUFDLFVBQTFCLENBQXFDLFlBQXJDLEVBQW1ELFNBQUMsVUFBRCxFQUFhLE1BQWIsRUFBcUIsYUFBckIsRUFBb0MsVUFBcEMsRUFBZ0QsUUFBaEQsRUFBMEQsUUFBMUQsRUFBb0UsYUFBcEUsRUFBbUYsUUFBbkY7QUFFL0MsUUFBQTtJQUFBLEtBQUEsR0FBUSxRQUFRLENBQUMsS0FBRCxDQUFSLENBQUE7SUFDUixRQUFBLEdBQVc7SUFFWCxTQUFBLEdBQVksU0FBQyxHQUFEO01BQ1IsS0FBSyxDQUFDLElBQU4sQ0FBVyxNQUFYLEVBQW1CLDJEQUFuQjthQUNBLFFBQUEsQ0FBUyxTQUFBO2VBQ0wsUUFBUSxDQUFDLElBQVQsR0FBZ0IsVUFBVSxDQUFDLE1BQU0sQ0FBQyxRQUFsQixHQUE2QixHQUE3QixHQUFtQyxDQUFJLEdBQUgsR0FBWSxHQUFaLEdBQXFCLEVBQXRCO01BRDlDLENBQVQsRUFFRSxJQUZGO0lBRlE7SUFNWixJQUFHLFVBQVUsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLE1BQW5CLENBQUEsQ0FBQSxLQUErQixDQUFsQzthQUNJLFNBQUEsQ0FBQSxFQURKO0tBQUEsTUFBQTtNQUdJLFVBQVUsQ0FBQyxFQUFFLENBQUMsS0FBZCxHQUNJO1FBQUEsSUFBQSxFQUFNLG1CQUFOO1FBQ0EsSUFBQSxFQUFNLGtCQUROOztNQUVKLE1BQU0sQ0FBQyxRQUFQLEdBQWtCLENBQ2QsVUFEYyxFQUVkLDBCQUZjO01BSWxCLE1BQU0sQ0FBQyxTQUFQLEdBQW1CLENBQ2YsVUFBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBdkIsR0FBaUMsSUFBakMsR0FBd0MsVUFBVSxDQUFDLE1BQU0sQ0FB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QUFYLEdBQXdCO01BRE4sQ0FBdEIsRUFwUEo7O0VBWCtDLENBQW5EO0FBREEiLCJmaWxlIjoiY2xpZW50L2xheWVycy93ZWJzaXRlL3RlbXBsYXRlcy9jcmFiL2pzL2NvbnRyb2xsZXJzL2ZpbmlzaEN0cmwuanMiLCJzb3VyY2VSb290IjoiL3NvdXJjZS8iLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcbmFuZ3VsYXIubW9kdWxlKCdtYWluQXBwJykuY29udHJvbGxlciAnZmluaXNoQ3RybCcsICgkcm9vdFNjb3BlLCAkc2NvcGUsICRsb2NhbFN0b3JhZ2UsICRnclJlc3RmdWwsICRnck1vZGFsLCAkZ3JBbGVydCwgJGNpZGFkZUVzdGFkbywgJHRpbWVvdXQpIC0+XG5cbiAgICBhbGVydCA9ICRnckFsZXJ0Lm5ldygpXG4gICAgZmluaXNoZWQgPSBmYWxzZVxuXG4gICAgY2FydEVtcHR5ID0gKHVybCkgLT5cbiAgICAgICAgYWxlcnQuc2hvdyAnaW5mbycsICdTdWEgbGlzdGEgZGUgcGVkaWRvcyBlc3TDoSB2YXppYSwgdm9jw6ogc2Vyw6EgcmVkaXJlY2lvbmFkbyEnXG4gICAgICAgICR0aW1lb3V0IC0+XG4gICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gJHJvb3RTY29wZS5HUklGRk8uY3VyQWxpYXMgKyAnLycgKyAoaWYgdXJsIHRoZW4gdXJsIGVsc2UgJycpXG4gICAgICAgICwgNTAwMFxuXG4gICAgaWYgJHJvb3RTY29wZS5nci5jYXJ0Lmxlbmd0aCgpID09IDBcbiAgICAgICAgY2FydEVtcHR5KClcbiAgICBlbHNlXG4gICAgICAgICRyb290U2NvcGUuZ3IudGl0bGUgPVxuICAgICAgICAgICAgaWNvbjogJ2ZhIGZhLWZ3IGZhLWNoZWNrJ1xuICAgICAgICAgICAgdGV4dDogJ0ZpbmFsaXphciBwZWRpZG8nXG4gICAgICAgICRzY29wZS5wYXltZW50cyA9IFtcbiAgICAgICAgICAgICdEaW5oZWlybydcbiAgICAgICAgICAgICdDYXJ0w6NvIGRlIENyw6lkaXRvL0TDqWJpdG8nXG4gICAgICAgIF1cbiAgICAgICAgJHNjb3BlLmFkZHJlc3NlcyA9IFtcbiAgICAgICAgICAgICRyb290U2NvcGUuR1JJRkZPLnVzZXIuYWRkcmVzcyArICcsICcgKyAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLm51bWJlciArIChpZiAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLmNvbXBsZW1lbnQgdGhlbiAnLCAnICsgJHJvb3RTY29wZS5HUklGRk8udXNlci5jb21wbGVtZW50IGVsc2UgJycpICsgJywgJyArICRyb290U2NvcGUuR1JJRkZPLnVzZXIuZGlzdHJpY3RcbiAgICAgICAgICAgICdPdXRyby4uLidcbiAgICAgICAgXVxuICAgICAgICAkc2NvcGUuc2hvcHMgPSBbXVxuXG4gICAgICAgICRnclJlc3RmdWwuZmluZChcbiAgICAgICAgICAgIG1vZHVsZTogJ3Nob3AnXG4gICAgICAgICAgICBhY3Rpb246ICdzZWxlY3QnKS50aGVuIChyKSAtPlxuICAgICAgICAgICAgaWYgci5yZXNwb25zZVxuICAgICAgICAgICAgICAgICRzY29wZS5zaG9wcyA9IHIucmVzcG9uc2VcblxuICAgICAgICAkc2NvcGUuc3RhdGVzID0gW11cblxuICAgICAgICBhbmd1bGFyLmZvckVhY2ggJGNpZGFkZUVzdGFkby5nZXQuZXN0YWRvcygpLCAoZSkgLT5cbiAgICAgICAgICAgICRzY29wZS5zdGF0ZXMucHVzaFxuICAgICAgICAgICAgICAgIHZhbHVlOiBlWzBdXG4gICAgICAgICAgICAgICAgbGFiZWw6IGVbMV1cbiAgICAgICAgICAgIHJldHVyblxuXG4gICAgICAgIGRlbGV0ZSAkbG9jYWxTdG9yYWdlLmdyaWZmb19jYXJ0X3JlYWR5XG5cbiAgICAgICAgJHNjb3BlLmZvcm1TZXR0aW5ncyA9XG4gICAgICAgICAgICBkYXRhOlxuICAgICAgICAgICAgICAgIHN0YXR1czogMFxuICAgICAgICAgICAgICAgIGRhdGU6IG5ldyBEYXRlXG4gICAgICAgICAgICAgICAgIyB0aW1lOiBtb21lbnQobmV3IERhdGUpLmZvcm1hdChcIkhIOm1tXCIpXG4gICAgICAgICAgICAgICAgdGltZTogJzAwOjAwJ1xuICAgICAgICAgICAgICAgIGZvcm1wYXltZW50OiAnRGluaGVpcm8nXG4gICAgICAgICAgICAgICAgYWRkcmVzczogJHNjb3BlLmFkZHJlc3Nlc1swXVxuICAgICAgICAgICAgICAgIHN0YXRlOiAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLnN0YXRlXG4gICAgICAgICAgICAgICAgY2l0eTogJHJvb3RTY29wZS5HUklGRk8udXNlci5jaXR5XG4gICAgICAgICAgICAgICAgZmtpZHNob3A6ICRyb290U2NvcGUuR1JJRkZPLnVzZXIuZmtpZHNob3BcbiAgICAgICAgICAgIHNjaGVtYTogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6ICdma2lkc2hvcCdcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCdcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdMb2phJ1xuICAgICAgICAgICAgICAgICAgICBsaXN0OiAnaXRlbS52YWx1ZSBhcyBpdGVtLmxhYmVsIGZvciBpdGVtIGluIHNob3BzJ1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiAxMlxuICAgICAgICAgICAgICAgICAgICBhdHRyOiByZXF1aXJlZDogdHJ1ZSwgbmdTaG93OiAnc2hvcHMubGVuZ3RoID4gMidcbiAgICAgICAgICAgICAgICAgICAgbXNnczogcmVxdWlyZWQ6ICdBIGxvamEgw6kgb2JyaWdhdMOzcmlhJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2RhdGUnXG4gICAgICAgICAgICAgICAgICB0eXBlOiAnZGF0ZSdcbiAgICAgICAgICAgICAgICAgIGxhYmVsOiAnRGF0YSBkbyBwZWRpZG8nXG4gICAgICAgICAgICAgICAgICBjb2x1bW5zOiA2XG4gICAgICAgICAgICAgICAgICBhdHRyOiByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgICAgICAgICAgbXNnczogcmVxdWlyZWQ6ICdBIGRhdGEgw6kgb2JyaWdhdMOzcmlhJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAjIHtcbiAgICAgICAgICAgICAgICAjICAgcHJvcGVydHk6ICd0aW1lJ1xuICAgICAgICAgICAgICAgICMgICB0eXBlOiAndGV4dCdcbiAgICAgICAgICAgICAgICAjICAgbGFiZWw6ICdIb3JhIGRvIHBlZGlkbydcbiAgICAgICAgICAgICAgICAjICAgY29sdW1uczogNlxuICAgICAgICAgICAgICAgICMgICBhdHRyOiByZXF1aXJlZDogdHJ1ZSwgZ3JNYXNrOiBcIic5OTo5OSdcIlxuICAgICAgICAgICAgICAgICMgICBtc2dzOiByZXF1aXJlZDogJ0EgaG9yYSDDqSBvYnJpZ2F0w7NyaWEnXG4gICAgICAgICAgICAgICAgIyB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2ZldGNoJ1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY2hlY2tib3gnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnVmFpIGJ1c2Nhcj8nXG4gICAgICAgICAgICAgICAgICAgICMgY29sdW1uczogMTJcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogNlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiAnZm9ybXBheW1lbnQnXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnRm9ybWEgZGUgcGFnYW1lbnRvJ1xuICAgICAgICAgICAgICAgICAgICBsaXN0OiAnaXRlbSBhcyBpdGVtIGZvciBpdGVtIGluIHBheW1lbnRzJ1xuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICchZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnQSBmb3JtYSBkZSBwYWdhbWVudG8gw6kgb2JyaWdhdMOzcmlhJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiAnY2hhbmdlJ1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbW9uZXknXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnTEFCRUwuQ0hBTkdFLkZPUidcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICcwLDAwJ1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiA2XG4gICAgICAgICAgICAgICAgICAgIGF0dHI6IG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5mb3JtcGF5bWVudCA9PT0gXFwnRGluaGVpcm9cXCcgJiYgIWZvcm1TZXR0aW5ncy5kYXRhLmZldGNoJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdocidcbiAgICAgICAgICAgICAgICAgICAgYXR0cjogJ25nLWlmJzogJyFmb3JtU2V0dGluZ3MuZGF0YS5mZXRjaCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2FkZHJlc3MnXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnRW5kZXJlw6dvIGRlIGVudHJlZ2EnXG4gICAgICAgICAgICAgICAgICAgIGxpc3Q6ICdpdGVtIGFzIGl0ZW0gZm9yIGl0ZW0gaW4gYWRkcmVzc2VzJ1xuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICchZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnTyBlbmRlcmXDp28gZGUgZW50cmVnYSDDqSBvYnJpZ2F0w7NyaW8nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6ICdhZGRyZXNzMSdcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdOb3ZvIGVuZGVyZcOnbydcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogOFxuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5hZGRyZXNzID09PSBcXCdPdXRyby4uLlxcJyAmJiAhZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnTyBub3ZvIGVuZGVyZcOnbyDDqSBvYnJpZ2F0w7NyaW8nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6ICdudW1iZXInXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdudW1iZXInXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnTsO6bWVybydcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogNFxuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5hZGRyZXNzID09PSBcXCdPdXRyby4uLlxcJyAmJiAhZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnTyBuw7ptZXJvIMOpIG9icmlnYXTDs3JpbydcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2NvbXBsZW1lbnQnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnQ29tcGxlbWVudG8nXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnM6IDZcbiAgICAgICAgICAgICAgICAgICAgYXR0cjogbmdJZjogJ2Zvcm1TZXR0aW5ncy5kYXRhLmFkZHJlc3MgPT09IFxcJ091dHJvLi4uXFwnICYmICFmb3JtU2V0dGluZ3MuZGF0YS5mZXRjaCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2Rpc3RyaWN0J1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0JhaXJybydcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uczogNlxuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5hZGRyZXNzID09PSBcXCdPdXRyby4uLlxcJyAmJiAhZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnTyBiYWlycm8gw6kgb2JyaWdhdMOzcmlvJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiAnc3RhdGUnXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnRXN0YWRvJ1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiA2XG4gICAgICAgICAgICAgICAgICAgIGxpc3Q6ICdpdGVtLnZhbHVlIGFzIGl0ZW0ubGFiZWwgZm9yIGl0ZW0gaW4gc3RhdGVzJ1xuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5hZGRyZXNzID09PSBcXCdPdXRyby4uLlxcJyAmJiAhZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnU2VsZWNpb25lIHVtIGVzdGFkbydcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogJ2NpdHknXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnXG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnQ2lkYWRlJ1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5zOiA2XG4gICAgICAgICAgICAgICAgICAgIGxpc3Q6ICdpdGVtLnZhbHVlIGFzIGl0ZW0ubGFiZWwgZm9yIGl0ZW0gaW4gY2l0aWVzJ1xuICAgICAgICAgICAgICAgICAgICBhdHRyOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5nSWY6ICdmb3JtU2V0dGluZ3MuZGF0YS5hZGRyZXNzID09PSBcXCdPdXRyby4uLlxcJyAmJiAhZm9ybVNldHRpbmdzLmRhdGEuZmV0Y2gnXG4gICAgICAgICAgICAgICAgICAgIG1zZ3M6IHJlcXVpcmVkOiAnU2VsZWNpb25lIHVtYSBjaWRhZGUnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgICAgc3VibWl0OiAoZGF0YSkgLT5cbiAgICAgICAgICAgICAgICByZXR1cm4gaWYgISRzY29wZS5mb3JtLiR2YWxpZFxuICAgICAgICAgICAgICAgIHRpbWUgPSBkYXRhLnRpbWUuc3BsaXQoJzonKVxuICAgICAgICAgICAgICAgIG9yZGVyID1cbiAgICAgICAgICAgICAgICAgICAgZmtpZGNsaWVudDogJHJvb3RTY29wZS5HUklGRk8udXNlci5pZFxuICAgICAgICAgICAgICAgICAgICBmZXRjaDogZGF0YS5mZXRjaFxuICAgICAgICAgICAgICAgICAgICBzdWJ0b3RhbDogJHJvb3RTY29wZS5nci5jYXJ0LnRvdGFsKClcbiAgICAgICAgICAgICAgICAgICAgZmtpZHNob3A6IGRhdGEuZmtpZHNob3BcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZDogbW9tZW50KGRhdGEuZGF0ZSkuaG91cih0aW1lWzBdKS5taW51dGUodGltZVsxXSkuc2Vjb25kKDApLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpXG4gICAgICAgICAgICAgICAgICAgIHByb2R1Y3RzOiBbXVxuXG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoICRyb290U2NvcGUuZ3IuY2FydC5pdGVtcywgKGl0ZW0pIC0+XG4gICAgICAgICAgICAgICAgICAgIGlmIGl0ZW0uY291bnQgPiAwXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5wcm9kdWN0cy5wdXNoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRwcm9kdWN0OiBpdGVtLmlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmtpZHNob3A6IGRhdGEuZmtpZHNob3BcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl0eTogaXRlbS5jb3VudFxuXG4gICAgICAgICAgICAgICAgaWYgIWRhdGEuZmV0Y2hcbiAgICAgICAgICAgICAgICAgICAgb3JkZXIuZm9ybXBheW1lbnQgPSBpZiBkYXRhLmZvcm1wYXltZW50IHRoZW4gZGF0YS5mb3JtcGF5bWVudCBlbHNlIHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICBvcmRlci5jaGFuZ2UgPSBpZiBkYXRhLmNoYW5nZSB0aGVuIGRhdGEuY2hhbmdlIGVsc2UgdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgIGlmIGRhdGEuYWRkcmVzcyA9PSAnT3V0cm8uLi4nXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5hZGRyZXNzID0gZGF0YS5hZGRyZXNzMVxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIubnVtYmVyID0gZGF0YS5udW1iZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmNvbXBsZW1lbnQgPSBkYXRhLmNvbXBsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmRpc3RyaWN0ID0gZGF0YS5kaXN0cmljdFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuY2l0eSA9IGRhdGEuY2l0eVxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIuc3RhdGUgPSBkYXRhLnN0YXRlXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmFkZHJlc3MgPSAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLmFkZHJlc3NcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLm51bWJlciA9ICRyb290U2NvcGUuR1JJRkZPLnVzZXIubnVtYmVyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5jb21wbGVtZW50ID0gJHJvb3RTY29wZS5HUklGRk8udXNlci5jb21wbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlci5kaXN0cmljdCA9ICRyb290U2NvcGUuR1JJRkZPLnVzZXIuZGlzdHJpY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLmNpdHkgPSAkcm9vdFNjb3BlLkdSSUZGTy51c2VyLmNpdHlcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyLnN0YXRlID0gJHJvb3RTY29wZS5HUklGRk8udXNlci5zdGF0ZVxuXG4gICAgICAgICAgICAgICAgJGdyUmVzdGZ1bC5jcmVhdGVcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlOiAnb3JkZXInXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogJ2luc2VydCdcbiAgICAgICAgICAgICAgICAgICAgcG9zdDogb3JkZXJcbiAgICAgICAgICAgICAgICAudGhlbiAocikgLT5cbiAgICAgICAgICAgICAgICAgICAgaWYgci5yZXNwb25zZVxuICAgICAgICAgICAgICAgICAgICAgICAgZmluaXNoZWQgPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZm9ybS5yZXNldCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdyLmNhcnQuY2xlYXIoKVxuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQuc2hvdyByLnN0YXR1cywgJ1NldSBwZWRpZG8gZm9pIGVudmlhZG8gY29tIHN1Y2Vzc28sIHZvY8OqIHNlcsOhIHJlZGlyZWNpb25hZG8gcGFyYSBhY29tcGFuaGFyIHNldSBwZWRpZG8uJ1xuICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQgKC0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9ICRyb290U2NvcGUuR1JJRkZPLmN1ckFsaWFzICsgJy91c2VyJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgICAgICAgICAgICAgKSwgNTAwMFxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGVydC5zaG93IHIuc3RhdHVzLCByLm1lc3NhZ2VcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgLCAtPlxuICAgICAgICAgICAgICAgICAgICBhbGVydC5zaG93ICdkYW5nZXInLCAnRVJST1IuRkFUQUwnXG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCAnZm9ybVNldHRpbmdzLmRhdGEuc3RhdGUnLCAoZSkgLT5cbiAgICAgICAgICAgIGlmIGVcbiAgICAgICAgICAgICAgICBpZiAkc2NvcGUuZm9ybVNldHRpbmdzLmRhdGEuc3RhdGVcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdGllcyA9IFtdXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCAkY2lkYWRlRXN0YWRvLmdldC5jaWRhZGVzKCRzY29wZS5mb3JtU2V0dGluZ3MuZGF0YS5zdGF0ZSksIChjKSAtPlxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNpdGllcy5wdXNoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogY1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY2l0aWVzID0gW11cbiAgICAgICAgICAgICAgICBpZiAkc2NvcGUuZm9ybVNldHRpbmdzLmRhdGEuc3RhdGUgPT0gJ1NQJ1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZm9ybVNldHRpbmdzLmRhdGEuY2l0eSA9ICdJdGFwZXZhJ1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZvcm1TZXR0aW5ncy5kYXRhLmNpdHkgPSB1bmRlZmluZWRcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAkc2NvcGUuZm9ybVNldHRpbmdzLmRhdGEuY2l0eSA9IHVuZGVmaW5lZFxuXG4gICAgICAgICRzY29wZS4kd2F0Y2ggLT5cbiAgICAgICAgICAgICRyb290U2NvcGUuZ3IuY2FydC5sZW5ndGgoKVxuICAgICAgICAsIC0+XG4gICAgICAgICAgICBjYXJ0RW1wdHkoKSBpZiAkcm9vdFNjb3BlLmdyLmNhcnQubGVuZ3RoKCkgPT0gMCBhbmQgIWZpbmlzaGVkXG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCAnZm9ybScsIChmb3JtKSAtPlxuICAgICAgICAgICAgJHJvb3RTY29wZS5maW5pc2hGb3JtID0gZm9ybVxuIl19